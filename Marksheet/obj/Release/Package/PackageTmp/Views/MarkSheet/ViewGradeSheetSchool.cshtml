@model List<Marksheet.ViewModels.GradeVM>
@{
    ViewBag.Title = "GradeSheet";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}
<style>

    #tbl {
        border-collapse: collapse;
        width: 100%;
        font-size: 12px;
    }

        #tbl td, #tbl th {
            border: 1px solid black;
            padding: 1px;
        }

    .alignleft {
        float: left;
        text-align: left;
        width: 50%;
    }

    .alignright {
        float: left;
        text-align: left;
        width: 50%;
    }

    .alignleft3 {
        float: left;
        text-align: center;
        width: 25%;
    }

    .alignright3 {
        float: right;
        text-align: center;
        width: 25%;
    }

    .aligncenter3 {
        float: left;
        text-align: center;
        width: 25%;
    }

    .aligncenter34 {
        float: left;
        text-align: center;
        width: 25%;
    }
</style>
<div class="card">
    <div class="card-header py-3">
        <h3 class="m-1 font-weight-bold center text-primary">School Wise Gradesheet </h3>
    </div>
    <div class="card-body">
        <div class="row" id="printDiv" style="font-size:12px;width:845px;">

            @foreach (var item in Model.AsEnumerable())
            {
                <div class="page">
                    <div class="first">
                        <div class="childFirst">
                            <div style="width:100%;min-height:3cm;">
                                <div style="width:10%;text-align:center;float:left;">
                                    <img style="max-height:100%;max-width:100%;" src="@Model[0].Logo" onerror="this.style.display='none'" />
                                    @*image location images/schoollogo.jpg*@
                                </div>
                                <div style="width:90%;text-align:center;float:left;">
                                    <b style="font-size:15px;">Siddheshwor Metropolitan/Sub-Metropolitan/Municipatility/Rural Municipatility</b><br />
                                    <b style="font-size:15px;">Basic Education Examination Committee </b><br /><b style="font-size:15px;"   >@Model[0].AcademicYear</b><br />

                                    <b style="font-size:15px;">BASIC EDUCATION CERTIFICATE(Grade-8)EXAMINATION </b><br />
                                    <b style="font-size:15px;">GRADE-SHEET</b>
                                </div>
                            </div>
                            <div style="width:100%;font-size:15px;">
                                <b> The Grade(s) Secured by</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @item.StudentName <br />
                                <b> Date Of Birth </b>    &nbsp;&nbsp;&nbsp;&nbsp;     @(item.DOBNep + "(in B.S.)")&nbsp;&nbsp;&nbsp; @( item.DOB + "(in AD)") <br />
                                <b>Symbol No</b>   &nbsp;&nbsp;&nbsp;&nbsp;    @item.RollNo<br />
                                <b> of </b>  &nbsp;&nbsp;&nbsp;&nbsp;     @item.SchoolName&nbsp;&nbsp;&nbsp; <b>School</b><br />
                                <b> In Basic Education (Grade 8) Examination of</b>     @item.AcademicYear <b>Given Below</b>
                                @*<div style="width:100%;"><b>NAME OF STUDENT:</b> @item.StudentName</div><div>&nbsp;</div>
                                    <div class="alignleft"><b>DATE OF BIRTH:</b> @item.DOB</div><div class="alignright"><b>CLASS:</b>8</div><div>&nbsp;</div>
                                    <div class="alignleft"><b>FATHER'S NAME:</b> @item.FatherName</div><div class="alignright"><b>SYMBOL NO:</b>8</div><div>&nbsp;</div>
                                    <div class="alignleft"><b>MOTHER'S NAME:</b> @item.MotherName</div><div class="alignright"><b>ADDRESS:</b>@item.StudentAddress</div><div>&nbsp;</div>*@
                            </div>
                            <div>&nbsp;<br /></div>
                        </div>
                    </div>
                    <div class="second">
                        <table id="tbl" style="min-height:13cm;">
                            <tr>
                                <th rowspan="2">S.No.</th>
                                <th rowspan="2">Subjects</th>
                                <th rowspan="2">Credit Hour</th>
                                <th colspan="2">Obtained Grade</th>
                                <th rowspan="2">Final Grade</th>
                                <th rowspan="2">Grade Point</th>
                                <th rowspan="2">Remarks</th>
                            </tr>
                            <tr>
                                <th>PR</th>
                                <th>TH</th>


                            </tr>
                            @foreach (var subitem in item.Subjects.OrderBy(m => m.Serial))
                            {
                                <tr>
                                    <td style="text-align:center;">@subitem.SerialNo</td>
                                    <td>@subitem.SubjectName</td>
                                    <td style="text-align:center;">@subitem.CreditHour</td>
                                    <td style="text-align:center;">@subitem.Practical</td>
                                    <td style="text-align:center;">@subitem.Theory</td>
                                    <td style="text-align:center;">@subitem.FinalGrade</td>
                                    <td style="text-align:center;">@subitem.GradePoint</td>
                                    <td>@subitem.Remarks</td>
                                </tr>
                            }
                            <tr>
                                <td colspan="6" style="text-align:center;">GRADE POINT AVERAGE(GPA)</td>
                                <td style="text-align:center;">@item.GPA</td>
                                <td style="text-align:center;">@item.AggregateGPA</td>
                            </tr>
                        </table>
                    </div>
                    <div>
                        <div>&nbsp;</div>
                        <div style="width:100%;">
                            <div style="float:left;text-align:left; width:70%;">
                                <b>1. Th : </b>Theory, <b><br />2. Pr :</b>Practical<br />
                                <b>@("3. @: Absent")</b>
                            </div>
                            <div class="width:30%;">&nbsp;</div>
                        </div>
                        <div style="width:100%;min-height:20px;">&nbsp;<br /><br /><br /><br /><br /></div>
                        <div style="width:100%;">
                            <div class="alignleft3">
                                <b>.....................<br /> Date of Issue:</b>
                            </div>
                            <div class="aligncenter3"><b>...................<br />Written by:</b></div>
                            <div class="aligncenter34"><b>..................<br />Checked by:</b></div>
                            <div class="alignright3"><b>.................<br />Verified by:</b></div>

                        </div>
                    </div>
                </div>



            }
        </div>
        <br />
        @*<div class="col-md-12" style="padding-left:200px;">*@
        <div class="col-md-10" style="text-align:center; padding-top:15px;">

            <input type="submit" class="btn btn-primary" id="btnPrint" value="Print" />

        </div>
    </div>
</div>


@section Scripts{
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/jqueryval")
    @Scripts.Render("~/bundles/jquery.ui")
    @Styles.Render("~/Content/css/jquery.ui")

    <script language="javascript">
        $(document).ready(function () {

            $("#btnPrint").click(function (e) {
                var html = "";
                html = formatHtml();
                PrintElem(html);

            });
        });
        function formatHtml() {
            var $divBoxs = $(".row").find("div.page");
            var html = "";
            var pageHead = "<div class='page'>";
            var pageBottom = "</div>";
            $.each($divBoxs, function (i, el) {
                html = html + pageHead + $(el).html() + pageBottom;
            });
            return html;
        }

        //    var $divBox1 = $("#printDiv").find("div.first");
        //    var $divBox2 = $("#printDiv").find("div.second");
        //    var $divBox3 = $("#printDiv").find("div.third");
        //    var html = "";
        //    var pageHead = "<div class='page'>";
        //    var pageBottom = "</div>";
        //    html = html + pageHead;
        //    html = html + "<div id='one'>" + $divBox1.html() + "</div>";
        //    html = html + "<div id='two'>" + $divBox2.html() + "</div>";
        //    html = html + "<div id='three'>" + $divBox3.html() + "</div>";
        //    html = html + pageBottom;
        //    return html;
        //}


        function PrintElem(ele) {
            var mywindow = window.open('', '_blank', 'PRINT');

            mywindow.document.write('<!DOCTYPE html><html><head><style>' +
                //'body {margin:0;padding:0;font:12pt;}*{box-sizing: border-box;-moz-box-sizing:border-box;}' +
                '.page {page-break-after:always;width: 21cm;min-height:26.7cm;padding: 0.5cm;margin:1cm auto;border: 1px black solid;background: white;box-sizing: border-box;-moz-box-sizing:border-box;}'
                + 'table#tbl {border-collapse: collapse !important;width: 100%;}#tbl td, #tbl th {border: 1px solid black !important;padding: 1px !important;} .alignleft3 {float: left;text-align:left;width: 25%;}.aligncenter3 {float: left;text-align:center;width: 25%;}.aligncenter34 {float: left;text-align:center;width: 25%;}.alignright3 {float: right;text-align: right;width: 24%;}' +
                '.alignleft {float:left;text-align:left; width:50%;}.alignright {float:left;text-align:left;width:50%;}' +

                'div#one{width:98%;float: left;}' +
                + 'div#two{width:98%;float: left;}' +
                'div#three{width:98%;float: left;}' +
                '</style><title>MarkSheet</title>');
            mywindow.document.write('</head><body >');
            mywindow.document.write(ele);
            mywindow.document.write('</body></html>');

            mywindow.document.close();
            mywindow.focus();

            mywindow.print();
            mywindow.close();

            return true;
        }

    </script>
}
