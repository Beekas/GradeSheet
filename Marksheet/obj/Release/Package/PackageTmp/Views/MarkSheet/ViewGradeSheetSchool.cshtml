@model List<Marksheet.ViewModels.GradeVM>
@{
    ViewBag.Title = "GradeSheet";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}
<style>

    #tbl {
        border-collapse: collapse;
        width: 100%;
        font-size: 12px;
    }

        #tbl td, #tbl th {
            border: 1px solid black;
            padding: 1px;
        }

    .alignleft {
        float: left;
        text-align: left;
        width: 50%;
    }

    .alignright {
        float: left;
        text-align: left;
        width: 50%;
    }

    .alignleft3 {
        float: left;
        text-align: center;
        width: 25%;
    }

    .alignright3 {
        float: right;
        text-align: center;
        width: 25%;
    }

    .aligncenter3 {
        float: left;
        text-align: center;
        width: 25%;
    }

    .aligncenter34 {
        float: left;
        text-align: center;
        width: 25%;
    }
</style>
<div class="card">
    <div class="card-header py-3">
        <h3 class="m-1 font-weight-bold center text-primary">School Wise Gradesheet </h3>
    </div>
    <div class="card-body">
        <div class="row" id="printDiv" style="font-size:12px;width:845px;">

            @foreach (var item in Model.AsEnumerable())
            {
                <div class="page">
                    <div class="first">
                        <div class="childFirst">
                            <div style="width:100%;min-height:3cm;">
                                <div style="width:15%;text-align:center;float:left;">
                                    <img style="max-height:100%;max-width:100%;" src="@Model[0].Logo" onerror="this.style.display='none'" />
                                    @*image location images/schoollogo.jpg*@
                                </div>
                                <div style="width:85%;text-align:center;float:left;margin-left:-3%;">
                                    <strong style="font-size:26px;font-family:'Malgun Gothic'">Siddhalek Rural Municipatility</strong><br />
                                    <b style="font-size:20px;">Basic Education Examination Committee </b><br />
                                    <label>Siddhalek, Dhading, 3 No. Province, Nepal</label><br />
                                    <b style="font-size:18px;">BASIC EDUCATION CERTIFICATE(Grade-8)EXAMINATION-@Model[0].AcademicYear</b><br />
                                    <strong style="font-size:26px;">GRADE-SHEET</strong>
                                    <br/>
                                </div>
                            </div><br/><br/><br/>
                            
                            <div style="width:100%;font-size:15px;line-height:25px;">
                                <b>SYMBOL NO: @item.RollNo</b><br />
                                The Grades Secured by Mr/Miss <b>@item.StudentName</b>&nbsp;&nbsp; son/daughter of <b>@item.FatherName</b><br />
                                student of <B>@item.SchoolName.ToUpper()</B>
                                &nbsp;<b>has appeared in the Annual Examination of @Model[0].AcademicYear B.S (@item.AcademicYearEng A.D) and completed Basic Education (Grade 8) Examination.</b>According to school record his/her date of birth is <b>@item.DOBNep</b>
                            </div>
                            <div>&nbsp;<br /></div>
                        </div>
                    </div>
                    <div class="second">
                        <table id="tbl" style="min-height:13cm;font-size:15px;">
                            <tr>
                                <th rowspan="2">S.N.</th>
                                <th rowspan="2">Subjects</th>
                                <th rowspan="2">Credit Hour</th>
                                <th colspan="2">Obtained Grade</th>
                                <th rowspan="2">Final Grade</th>
                                <th rowspan="2">Grade Point</th>
                                <th rowspan="2">Remarks</th>
                            </tr>
                            <tr>
                                <th>PR</th>
                                <th>TH</th>


                            </tr>
                            @foreach (var subitem in item.Subjects.OrderBy(m => m.Serial))
                            {
                                <tr>
                                    <td style="text-align:center;">@subitem.SerialNo</td>
                                    <td>@subitem.SubjectName</td>
                                    <td style="text-align:center;">@subitem.CreditHour</td>
                                    <td style="text-align:center;">@subitem.Practical</td>
                                    <td style="text-align:center;">@subitem.Theory</td>
                                    <td style="text-align:center;">@subitem.FinalGrade</td>
                                    <td style="text-align:center;">@subitem.GradePoint</td>
                                    <td>@subitem.Remarks</td>
                                </tr>
                            }
                            <tr style="font-weight:bold;">
                                <td colspan="6" style="text-align:right;">GRADE:</td>
                                <td colspan="2" style="text-align:left;">@item.Grade</td>
                            </tr>
                            <tr style="font-weight:bold;"> 
                                <td colspan="6" style="text-align:right;">GRADE POINT AVERAGE(GPA):</td>
                                <td colspan="2" style="text-align:left;">@item.GPA</td>

                            </tr>
                            <tr style="font-weight:bold;">
                                <td colspan="6" style="text-align:right;">Result:</td>
                                <td colspan="2" style="text-align:left;">@item.AggregateGPA</td>
                            </tr>
                        </table>
                    </div>
                    <div>
                        <div>&nbsp;</div>
                        <div style="width:100%;line-height:20px;">
                            <b>
                                *Grading: A+:Outstanding, A:Excellent, B+:Very Good, B:Good, C+:Satisfactory,C:Acceptable,
                                D+:Partially Acceptable, D:Insufficient, E:Very Insufficient
                            </b>
                        </div>
                        <div style="width:100%;line-height:20px;">
                            <div style="float:left;text-align:left; width:70%;">
                                TH : <b>Theory, </b><br />PR :<b>Practical</b><br />
                                @("@")<b>  Absent</b>
                            </div>
                            <div class="width:30%;">&nbsp;</div>
                        </div>
                        <div style="width:100%;min-height:20px;">&nbsp;<br /><br /><br /><br /></div>
                        <div style="width:100%;">
                            <div class="alignleft3">
                                <div style="border:1px solid black;min-height:100px;width:200px;"><br />&nbsp;&nbsp;</div>
                            </div>
                            <div class="aligncenter3"><b>...............................<br />HEAD TEACHER</b></div>
                            <div class="aligncenter34"><b>.........................<br />CHECKED BY</b></div>
                            <div class="alignright3"><b>........................<br />VERIFIED BY</b></div>

                        </div>
                        <div style="width:100%;">
                            &nbsp;&#9;
                        </div>
                        <div style="width:100%">
                            <div class="alignleft3">
                               
                            </div>
                            <div style="width:50%;float:left;text-align:left;padding-left:20px;"> <br /><br /><b>DATE OF ISSUE: @Model[0].DateOfIssue</b></div>
                          

                        </div>
                    </div>
                </div>
            }
        </div>
        <br />
        @*<div class="col-md-12" style="padding-left:200px;">*@
        <div class="col-md-10" style="text-align:center; padding-top:15px;">

            <input type="submit" class="btn btn-primary" id="btnPrint" value="Print" />

        </div>
    </div>
</div>


@section Scripts{
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/jqueryval")
    @Scripts.Render("~/bundles/jquery.ui")
    @Styles.Render("~/Content/css/jquery.ui")

    <script language="javascript">
        $(document).ready(function () {

            $("#btnPrint").click(function (e) {
                var html = "";
                html = formatHtml();
                PrintElem(html);

            });
        });
        function formatHtml() {
            var $divBoxs = $(".row").find("div.page");
            var html = "";
            var pageHead = "<div class='page'>";
            var pageBottom = "</div>";
            $.each($divBoxs, function (i, el) {
                html = html + pageHead + $(el).html() + pageBottom;
            });
            return html;
        }
        

        function PrintElem(ele) {
            var mywindow = window.open('', '_blank', 'PRINT');

            mywindow.document.write('<!DOCTYPE html><html><head><style>' +
                //'body {margin:0;padding:0;font:12pt;}*{box-sizing: border-box;-moz-box-sizing:border-box;}' +
                '.page {page-break-after:always;width: 21cm;min-height:28.5cm;padding: 0.5cm;margin:1cm auto;border: 5px black solid;background: white;box-sizing: border-box;-moz-box-sizing:border-box;}'
                + 'table#tbl {border-collapse: collapse !important;width: 100%;}#tbl td, #tbl th {border: 1px solid black !important;padding: 1px !important;} .alignleft3 {float: left;text-align:left;width: 25%;}.aligncenter3 {float: left;text-align:center;width: 25%;}.aligncenter34 {float: left;text-align:center;width: 25%;}.alignright3 {float: right;text-align: right;width: 24%;}' +
                '.alignleft {float:left;text-align:left; width:50%;}.alignright {float:left;text-align:left;width:50%;}' +
                'div#one{width:98%;float: left;}' +
                + 'div#two{width:98%;float: left;}' +
                'div#three{width:98%;float: left;}' +
                '</style><title>MarkSheet</title>');
            mywindow.document.write('</head><body >');
            mywindow.document.write(ele);
            mywindow.document.write('</body></html>');

            mywindow.document.close();
            mywindow.focus();

            mywindow.print();
            mywindow.close();

            return true;
        }

    </script>
}
